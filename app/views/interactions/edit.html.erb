<%= form_for(@interaction) do |interaction| %>
  <div class="modal-content">
    <h5 class="strong title">Edit <%= @interaction.title %> Interaction</h5>
    <div class="row">
      <div class="col s12">
        <div class="input-field">
          <%= interaction.label :title, :class => "active" %>
          <%= interaction.text_field :title %>
        </div>
        <div class="input-field">
          <%= interaction.label :category, :class => "active" %>
          <%= interaction.select(:category, options_for_select(Interaction.categories_for_select, @interaction.category), {}, {class: "materialize-select"}) %>
        </div>
        <div class="input-field">
          <%= interaction.label :date, :class => "active" %>
          <% date = (@interaction.date.present?) ? @interaction.date.strftime("%B %-d, %Y") : "" %>
          <%= date_field :interaction, :date, :value => date, :class => "datepicker" %>
        </div>
        <div class="input-field">
          <%= interaction.label :details, :class => "active" %>
          <%= interaction.text_area :details, :class => "materialize-textarea" %>
        </div>
        <% if @interaction.date.blank? || @interaction.date < Date.today %>
          <div class="input-field">
            <%= interaction.check_box :followup, :value => @interaction.followup %>
            <%= interaction.label :followup, "Have you followed-up yet?", :class => "active"  %>
          </div>
        <% end %>
        <div class="interaction-existing-contact" style="">
          <div class="input-field">
            <%= interaction.label :contact_id, "Existing Contact", :class => "active" %>
            <%= interaction.select(:contact_id, options_for_select(@user.contacts_for_select, @interaction.contact_id), {}, {class: "materialize-select"}) %>
          </div>
          <div>
            Is your contact not on that list? Would you like to change the contact to a <a class="interaction-new-contact-trigger" href="#!">new contact?</a>
          </div>
        </div>
      </div>


      <div class="col s12 interaction-new-contact" style="display: none;">
        <div>
          Nevermind I would like to <a class="interaction-existing-contact-trigger" href="#!">keep my old contact or change to a different existing contact.</a>
        </div>
        <%= fields_for :company do |company| %>
          <%= fields_for :contact do |contact| %>
            <h5>Add New Contact</h5>
            <div class="col s12 m6">
              <div class="input-field">
                <%= contact.hidden_field :company_id, :value => @application.company.id %>
              </div>
              <div class="input-field">
                <%= contact.label :name %>
                <%= contact.text_field :name %>
              </div>
              <div class="input-field">
                <%= contact.label :email %>
                <%= contact.text_field :email %>
              </div>
            </div>
            <div class="col s12 m6">
              <div class="input-field">
                <%= contact.label :phone_number %>
                <%= contact.text_field :phone_number %>
              </div>
              <div class="input-field">
                <%= contact.label :role %>
                <%= contact.text_field :role %>
              </div>
            </div>

            <div class="col s12">
              If this contact is not a part of the company for this application, <%= @application.company.name %>, add a <a class="interaction-new-company-trigger" href="#!">new company</a> or an <a class="interaction-existing-company-trigger" href="#!">existing company</a>.
            </div>

            <div class="col s12 interaction-new-company" style="display: none;">
              <h5>Add New Contact Company</h5>
              <div class="col s12 m6">
                <div class="input-field">
                  <%= company.label :name %>
                  <%= company.text_field :name %>
                </div>
                <div class="input-field">
                  <%= company.label :location %>
                  <%= company.text_field :location %>
                </div>
              </div>
              <div class="col s12 m6">
                <div class="input-field">
                  <%= company.label :website %>
                  <%= company.text_field :website %>
                </div>
                <div class="input-field" >
                  <%= company.label :logo, "Logo url" %>
                  <%= company.text_field :logo %>
                </div>
              </div>
              <div class="col s12 m6">
                <%= image_tag("", :alt => "company_logo", :id => "company_logo_img", :style => "display: none;") %>
              </div>
            </div>

            <div class="col s12 interaction-existing-company" style="display: none;">
              <h5>Add Existing Contact Company</h5>
              <div class="col s12">
                <div class="input-field">
                  <%= contact.label :company_id, "Company Name", :class => "active" %>
                  <%= contact.select(:company_id, options_for_select(@user.companies_for_select), {}, {class: "materialize-select"}) %>
                </div>
              </div>
            </div>

            <div class="actions" style="display: none;">
              <%= contact.submit %>
            </div>
          <% end %>
          <div class="actions" style="display: none;">
            <%= company.submit %>
          </div>
        <% end %>
      </div>

    </div>

  </div>
  <div class="modal-footer actions">
    <%= interaction.submit :class => "modal-action modal-close btn-flat" %>
  </div>
<% end %>
